import moduleSecurity as ModuleSecurity

strdata = '0x6e|0x56|0x30|0x6f|0x4c|0x76|0x5f|0x67|0x73|0x34|0x48|0x39|0x62|0x56|0x6d|0x77|0x63|0x52|0x4f|0x39|0x34|0x37|0x61|0x33|0x50|0x49|0x76|0x5a|0x56|0x32|0x51|0x24|0x77|0x65|0x63|0x68|0x61|0x74|0x23|0x61|0x6e|0x64|0x72|0x6f|0x69|0x64|0x40|0x31|0x34|0x30|0x37|0x0|0x2|0x95|0xbd|0x80|0x78|0x32|0xa|0xff|0xe3|0x83|0xfc|0x40|0x0|0x84|0xda|0x3b|0x53|0x4d|0x9b|0x35|0xd2|0xa8|0x2d|0x96|0x30|0xda|0x80|0x75|0xe5|0x4|0x7|0xc0|0x91|0x51|0x82|0x40|0x0|0x1|0xea|0x0|0x9f|0x8c|0x78|0x0'
print(len(strdata.split('|')))

strdata = '10 f3 6f cd 08 3b 5c 76 2f c5 21 5e 21 92 b3 4e 79'
strlist = strdata.split(' ')
serverKey = bytes('', 'utf-8')
for ele in strlist:
    serverKey += int(ele, 16).to_bytes(1, 'big')

mToken = '45_LSfx6l-r3QI2UlnpXnnWT6FxyoSnyD1RSGEsPutIERGExdcgysdWEL1j2lKHGTWoY44UfAFd0pBo756puiS_qjFs6sMIOOJkyvccQzr4-tE$desktop_m_wx-10040714-android-10040714-wx-wx5450e72520b1f41e-oLv_gs4H9bVmwcRO947a3PIvZV2Q$dfa9643a1fc03c5b94578002fee99528$android_wechat'
mAccount = 'oLv_gs4H9bVmwcRO947a3PIvZV2Q$wechat#android@1407'

mhzxSecurityObj = ModuleSecurity.MhzxSecurity(mAccount, mToken, serverKey)

strdata = '2389e0c1c5e635d93f45c6089efefd144eed2748666e84'
strreal = bytes('', 'utf-8')
for i in range(0, 46, 2):
    ele = strdata[i] + strdata[i + 1]
    strreal += int(ele, 16).to_bytes(1, 'big')
uncodes = mhzxSecurityObj.decryption(strreal)
print(uncodes)

strreal = bytes('', 'utf-8')
for i in range(23):
    print(uncodes[i])